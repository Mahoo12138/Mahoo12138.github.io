<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Flutter 入门学习之本地存储 [ Mahoo12138 ]</title><link rel="stylesheet" href="/css/index.css"><meta name="post"><link rel="stylesheet" href="/css/layouts/post.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="hexo-container"><header></header><main id="content"><article id="post"><h1>Flutter 入门学习之本地存储</h1><h2 id="什么是-shared-preferences"><a href="#什么是-shared-preferences" class="headerlink" title="什么是 shared_preferences"></a>什么是 shared_preferences</h2><p>shared_preferences是Flutter社区开发的一个本地数据存取插件，它有以下特性：</p>
<ul>
<li>简单的，异步的，持久化的key-value存储系统；</li>
<li>在Android上它是基于 SharedPreferences 的；</li>
<li>在iOS上它是基于<a target="_blank" rel="noopener" href="https://coding.imooc.com/class/321.html?mc_marking=f0d19be86650c0e77daa6fe37e140ded&mc_channel=shouji">NSUserDefaults</a>的；</li>
</ul>
<h2 id="如何使用-shared-preferences"><a href="#如何使用-shared-preferences" class="headerlink" title="如何使用 shared_preferences"></a>如何使用 shared_preferences</h2><p>首先在pubspec.yaml文件中添加：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dependencies:</span><br><span class="line">  shared_preferences: any</span><br></pre></td></tr></table></figure>


<p>在需要用到的文件中导入：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:shared_preferences/shared_preferences.dart&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>基本使用：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">存储数据</span></span></span><br><span class="line">_saveData(Number data) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="comment">// 因为SharedPreferences的存贮也是一个轻量级的耗时操作，所以需要在异步中进行的。</span></span><br><span class="line">  SharedPreferences prefs = <span class="keyword">await</span> SharedPreferences.getInstance();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">await</span> prefs.setInt(<span class="string">&#x27;number&#x27;</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// <span class="language-markdown">读取数据</span></span></span><br><span class="line">Number _getData() <span class="keyword">async</span> &#123;</span><br><span class="line">    SharedPreferences prefs = <span class="keyword">await</span> SharedPreferences.getInstance();</span><br><span class="line">	<span class="keyword">var</span> data = prefs.getInt(<span class="string">&#x27;number&#x27;</span>) ?? <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// <span class="language-markdown">删除数据</span></span></span><br><span class="line">_deleteData() &#123;</span><br><span class="line">  	SharedPreferences prefs = <span class="keyword">await</span> SharedPreferences.getInstance();</span><br><span class="line">	prefs.remove(<span class="string">&#x27;number&#x27;</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="常用-API"><a href="#常用-API" class="headerlink" title="常用 API"></a>常用 API</h2><p>如上述代码，<code>shared_preferences</code>支持 int, double, bool, string 与 stringList 类型的数据存储；</p>
</article><div id="paginator"></div></main><footer><div class="icon-wrapper in-left"><button class="icon-button" aria-label="change theme"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" height="100%" width="100%"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg></span></button></div><div class="icon-wrapper in-right"><button class="icon-button" aria-label="change theme"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" height="100%" width="100%"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg></span></button></div><p class="copyright-text"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer">CC BY-NC-SA 4.0</a><span>·</span><a href="https://github.com/ttttonyhe/ouorz-mono" target="_blank" rel="noreferrer">Open Source Software (OSS)</a></p></footer><script src="/js/ouo.js"></script></div></body></html>